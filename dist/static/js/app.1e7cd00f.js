(function(e){function t(t){for(var o,n,a=t[0],i=t[1],d=t[2],s=0,m=[];s<a.length;s++)n=a[s],Object.prototype.hasOwnProperty.call(c,n)&&c[n]&&m.push(c[n][0]),c[n]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);b&&b(t);while(m.length)m.shift()();return r.push.apply(r,d||[]),l()}function l(){for(var e,t=0;t<r.length;t++){for(var l=r[t],o=!0,a=1;a<l.length;a++){var i=l[a];0!==c[i]&&(o=!1)}o&&(r.splice(t--,1),e=n(n.s=l[0]))}return e}var o={},c={app:0},r=[];function n(t){if(o[t])return o[t].exports;var l=o[t]={i:t,l:!1,exports:{}};return e[t].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=o,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(l,o,function(t){return e[t]}.bind(null,o));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var b=i;r.push([0,"chunk-vendors"]),l()})({0:function(e,t,l){e.exports=l("cd49")},"2de5":function(e,t,l){"use strict";l("88d1")},"88d1":function(e,t,l){},cd49:function(e,t,l){"use strict";l.r(t);var o=l("7a23"),c=l("3ef4"),r=l("f6f2");const n={class:"app-div"},a=Object(o["createElementVNode"])("div",{class:"title-div"},[Object(o["createElementVNode"])("h1",null,"公司工时统计系统")],-1),i={class:"workTime-div"},d={class:"workTime-table"},b={key:0},s={key:1},m={key:0},u={key:1},p=Object(o["createElementVNode"])("div",{class:"el-upload__text"},[Object(o["createTextVNode"])(" 将文件拖拽到此处会点击 "),Object(o["createElementVNode"])("em",null,"读取文件")],-1),O=Object(o["createElementVNode"])("div",{class:"el-upload__tip",style:{"text-align":"center"}},[Object(o["createElementVNode"])("h3",null,"请上传文本文件！")],-1),j={class:"workTime-use"},w={class:"function"},k=Object(o["createElementVNode"])("h1",null,"功能模块",-1),f=Object(o["createTextVNode"])("计算工时"),h={class:"info"},T=Object(o["createElementVNode"])("h1",null,"工时统计",-1),V=Object(o["createTextVNode"])(" 当月工作时长："),v=Object(o["createTextVNode"])(" 天 "),x=Object(o["createElementVNode"])("br",null,null,-1),y=Object(o["createTextVNode"])(" 总工时："),N=Object(o["createTextVNode"])(" 时 "),g=Object(o["createElementVNode"])("br",null,null,-1),E=Object(o["createTextVNode"])(" 日平均工时： "),C=Object(o["createTextVNode"])(" 时 "),_=Object(o["createElementVNode"])("br",null,null,-1),B={key:0,class:"info"},S={key:0,style:{color:"green"}},D={key:1,style:{color:"red"}},W=Object(o["createElementVNode"])("div",{class:"guide"},[Object(o["createElementVNode"])("h1",{style:{"text-align":"center"}},"使用说明"),Object(o["createElementVNode"])("div",{style:{"margin-left":"10px"}},[Object(o["createElementVNode"])("h5",null,"1.在OA系统中，将需要计算的工时复制到txt文本中；(参考src/assets/test.txt格式)"),Object(o["createElementVNode"])("h5",null,"2.点击表格区域的读取文件按钮打开工时文件，或将工时文件拖拽至目标区域；"),Object(o["createElementVNode"])("h5",null,"3.将有上下班未打卡的时间补充完整(双击单元格更改)；"),Object(o["createElementVNode"])("h5",null,"4.点击计算工时按钮，查看工时统计信息。")])],-1);var P=Object(o["defineComponent"])({__name:"App",setup(e){const t=Object(o["reactive"])({workTime:[],clickRow:0,clickCell:0,tabClickLabel:"",totalWorkTime:"0",dailyWorkTime:"0",isCalWorkTime:!1}),l=e=>{if("txt"===e.name.split(".").slice(-1)[0])if(window.FileReader){var l=new FileReader;l.onload=e=>{t.workTime.splice(0);const l=e.target.result.split("\n");P(l)},l.readAsText(e.raw)}else c["a"].error("该浏览器不支持文件读取 请更改浏览器 推荐使用谷歌浏览器");else c["a"].error("请选择正确的txt文件")},P=e=>{try{for(let l=0;l<e.length;l++)if(""!==e[l]){const o=e[l].split("\t");t.workTime.push({index:l,id:o[1],name:o[2],date:o[3],startTime:o[4],endTime:o[5]})}}catch(l){c["a"].error("无法正确解析该txt文件")}},R=()=>{if(0===t.workTime.length)return void c["a"].error("请先读取工时文件！");let e=0;for(let l=0;l<t.workTime.length;l++){if(" "===t.workTime[l].startTime||" "===t.workTime[l].endTime)return void c["a"].error("第"+(l+1).toString()+"列有未完成的上下班打卡 请先双击表格填写完整！");{const o=new Date(t.workTime[l].date+" "+t.workTime[l].startTime);o.getHours()<=8&&o.getMinutes()<=30&&(t.workTime[l].startTime="08:30:00");const r=Date.parse(t.workTime[l].date+" "+t.workTime[l].endTime)-Date.parse(t.workTime[l].date+" "+t.workTime[l].startTime);if(!(r>0))return void c["a"].error("第"+(l+1).toString()+"列数据打卡时间异常！请确定下班时间大于上班时间！");e+=r/1e3/60}}t.totalWorkTime=(e/60).toFixed(2),t.dailyWorkTime=(e/60/t.workTime.length).toFixed(2),t.isCalWorkTime=!0},K=(e,l)=>{"上班时间"!==l.label&&"下班时间"!==l.label||(t.clickRow=e.index,t.clickCell=l.index,t.tabClickLabel=l.label)},F=({row:e,rowIndex:t})=>{e.index=t},M=({column:e,columnIndex:t})=>{e.index=t},A=()=>{t.clickRow=0,t.clickCell=0,t.tabClickLabel=""};return(e,c)=>{const P=Object(o["resolveComponent"])("el-table-column"),U=Object(o["resolveComponent"])("el-input"),z=Object(o["resolveComponent"])("el-table"),L=Object(o["resolveComponent"])("el-button"),I=Object(o["resolveComponent"])("el-icon"),J=Object(o["resolveComponent"])("el-upload");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",n,[a,Object(o["createElementVNode"])("div",i,[Object(o["createElementVNode"])("div",d,[Object(o["createVNode"])(z,{data:t.workTime,border:"",style:{width:"1100px"},onCellDblclick:K,"row-class-name":F,"cell-class-name":M},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(P,{align:"center",label:"序号",width:"100"},{default:Object(o["withCtx"])(e=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.row.index+1),1)]),_:1}),Object(o["createVNode"])(P,{prop:"id",align:"center",label:"工号",width:"200"}),Object(o["createVNode"])(P,{prop:"name",align:"center",label:"姓名",width:"200"}),Object(o["createVNode"])(P,{prop:"date",align:"center",label:"日期",width:"200"}),Object(o["createVNode"])(P,{align:"center",label:"上班时间",width:"200"},{default:Object(o["withCtx"])(e=>[e.row.index===t.clickRow&&e.column.index===t.clickCell?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",b,[Object(o["createVNode"])(U,{modelValue:e.row.startTime,"onUpdate:modelValue":t=>e.row.startTime=t,maxlength:"300",size:"small",onKeyup:Object(o["withKeys"])(A,["enter"]),onBlur:A},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",s,Object(o["toDisplayString"])(e.row.startTime),1))]),_:1}),Object(o["createVNode"])(P,{align:"center",label:"下班时间",width:"200","show-overflow-tooltip":""},{default:Object(o["withCtx"])(e=>[e.row.index===t.clickRow&&e.column.index===t.clickCell?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",m,[Object(o["createVNode"])(U,{modelValue:e.row.endTime,"onUpdate:modelValue":t=>e.row.endTime=t,maxlength:"300",size:"small",onKeyup:Object(o["withKeys"])(A,["enter"]),onBlur:A},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",u,Object(o["toDisplayString"])(e.row.endTime),1))]),_:1})]),_:1},8,["data"]),Object(o["withDirectives"])(Object(o["createVNode"])(L,{style:{position:"absolute",left:"12px",top:"118px","z-index":"2"},type:"primary",icon:Object(o["unref"])(r["a"]),circle:"",onClick:c[0]||(c[0]=e=>t.workTime.splice(0))},null,8,["icon"]),[[o["vShow"],0!==t.workTime.length]]),Object(o["withDirectives"])(Object(o["createVNode"])(J,{class:"upload-demo",drag:"",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",multiple:"","on-change":l},{tip:Object(o["withCtx"])(()=>[O]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(I,{class:"el-icon--upload"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(Object(o["unref"])(r["a"]))]),_:1}),p]),_:1},512),[[o["vShow"],0===t.workTime.length]])]),Object(o["createElementVNode"])("div",j,[Object(o["createElementVNode"])("div",w,[k,Object(o["createVNode"])(L,{type:"primary",onClick:R,style:{"margin-left":"10px"}},{default:Object(o["withCtx"])(()=>[f]),_:1})]),Object(o["createElementVNode"])("div",h,[T,V,Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.workTime.length),1),v,x,y,Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.totalWorkTime),1),N,g,E,Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.dailyWorkTime),1),C,_]),t.isCalWorkTime?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",B,[parseFloat(t.dailyWorkTime)>=8.5?(Object(o["openBlock"])(),Object(o["createElementBlock"])("h3",S,"您的工时已达到公司要求 请再接再厉！")):(Object(o["openBlock"])(),Object(o["createElementBlock"])("h3",D,"您的工时未达到公司要求 请及时调整！"))])):Object(o["createCommentVNode"])("",!0),W])])])}}});l("2de5");const R=P;var K=R,F=l("c3a1"),M=(l("7437"),l("a471"),l("3ef0")),A=l.n(M);const U=Object(o["createApp"])(K);U.use(F["a"],{locale:A.a}),U.mount("#app")}});