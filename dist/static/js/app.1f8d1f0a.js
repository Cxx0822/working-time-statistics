(function(e){function t(t){for(var o,n,a=t[0],i=t[1],d=t[2],b=0,s=[];b<a.length;b++)n=a[b],Object.prototype.hasOwnProperty.call(c,n)&&c[n]&&s.push(c[n][0]),c[n]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);m&&m(t);while(s.length)s.shift()();return r.push.apply(r,d||[]),l()}function l(){for(var e,t=0;t<r.length;t++){for(var l=r[t],o=!0,a=1;a<l.length;a++){var i=l[a];0!==c[i]&&(o=!1)}o&&(r.splice(t--,1),e=n(n.s=l[0]))}return e}var o={},c={app:0},r=[];function n(t){if(o[t])return o[t].exports;var l=o[t]={i:t,l:!1,exports:{}};return e[t].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=o,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(l,o,function(t){return e[t]}.bind(null,o));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var m=i;r.push([0,"chunk-vendors"]),l()})({0:function(e,t,l){e.exports=l("cd49")},"0850":function(e,t,l){},aab9:function(e,t,l){"use strict";l("0850")},cd49:function(e,t,l){"use strict";l.r(t);var o=l("7a23"),c=l("3ef4"),r=l("f6f2");const n={class:"app-div"},a=Object(o["createElementVNode"])("div",{class:"title-div"},[Object(o["createElementVNode"])("h1",null,"公司工时统计系统")],-1),i={class:"workTime-div"},d={class:"workTime-table"},m={key:0},b={key:1},s={key:0},u={key:1},p={key:0},O={key:1},j=Object(o["createElementVNode"])("div",{class:"el-upload__text"},[Object(o["createElementVNode"])("h3",null,"将文件拖拽到此处或点击图标上传文件")],-1),k=Object(o["createElementVNode"])("div",{class:"el-upload__tip",style:{"text-align":"center"}},[Object(o["createElementVNode"])("h3",null,"请上传文本文件！")],-1),w={class:"workTime-use"},f={class:"function"},T=Object(o["createElementVNode"])("h1",null,"功能模块",-1),h=Object(o["createTextVNode"])("保存本地数据"),y=Object(o["createTextVNode"])("读取本地数据"),x=Object(o["createTextVNode"])("计算工时"),V={class:"info"},v=Object(o["createElementVNode"])("h1",null,"工时统计",-1),g=Object(o["createTextVNode"])(" 当月工作时长："),N=Object(o["createTextVNode"])(" 天 "),C=Object(o["createElementVNode"])("br",null,null,-1),E=Object(o["createTextVNode"])(" 总工时："),B=Object(o["createTextVNode"])(" 时 "),_=Object(o["createElementVNode"])("br",null,null,-1),S=Object(o["createTextVNode"])(" 日平均工时： "),D=Object(o["createTextVNode"])(" 时 "),R=Object(o["createElementVNode"])("br",null,null,-1),W={key:0,class:"info"},K={key:0,style:{color:"green"}},P={key:1,style:{color:"red"}},U=Object(o["createElementVNode"])("div",{class:"guide"},[Object(o["createElementVNode"])("h1",{style:{"text-align":"center"}},"使用说明"),Object(o["createElementVNode"])("div",{style:{"margin-left":"10px"}},[Object(o["createElementVNode"])("h5",null,"1.在OA系统中，将需要计算的工时复制到txt文本中；(参考src/assets/test.txt格式)"),Object(o["createElementVNode"])("h5",null,"2.点击表格区域的上传文件按钮打开工时文件，或将工时文件拖拽至目标区域；"),Object(o["createElementVNode"])("h5",null,"3.将有上下班未打卡的时间补充完整(双击单元格更改)；"),Object(o["createElementVNode"])("h5",null,"4.点击计算工时按钮，查看工时统计信息。")])],-1);var z=Object(o["defineComponent"])({__name:"App",setup(e){const t=Object(o["ref"])(),l=Object(o["reactive"])({workTime:[],clickRow:0,clickCell:0,tabClickLabel:"",totalWorkTime:"0",dailyWorkTime:"0",isCalWorkTime:!1});let z="";const F=e=>{if("txt"===e.name.split(".").slice(-1)[0])if(window.FileReader){var t=new FileReader;t.onload=e=>{l.workTime.splice(0);const t=e.target.result.split("\n");M(t)},t.readAsText(e.raw)}else c["a"].error("该浏览器不支持文件读取 请更改浏览器 推荐使用谷歌浏览器");else c["a"].error("请选择正确的txt文件")},M=e=>{try{for(let t=0;t<e.length;t++)if(""!==e[t]){const o=e[t].split("\t");l.workTime.push({index:t,id:o[1],name:o[2],date:o[3],startTime:o[4],endTime:o[5]})}}catch(t){c["a"].error("无法正确解析该txt文件")}},A=()=>{l.workTime.push({index:l.workTime.length+1,id:"",name:"",date:"",startTime:"",endTime:""}),l.clickRow=l.workTime.length-1,l.clickCell=3,Object(o["nextTick"])(()=>{t.value.input.focus()})},I=()=>{if(0===l.workTime.length)return void c["a"].error("请先读取工时文件！");let e=0;for(let t=0;t<l.workTime.length;t++){if(" "===l.workTime[t].startTime||" "===l.workTime[t].endTime)return void c["a"].error("第"+(t+1).toString()+"列有未完成的上下班打卡 请先双击表格填写完整！");{const o=new Date(l.workTime[t].date+" "+l.workTime[t].startTime);o.getHours()<=8&&o.getMinutes()<=30&&(l.workTime[t].startTime="08:30:00");const r=Date.parse(l.workTime[t].date+" "+l.workTime[t].endTime)-Date.parse(l.workTime[t].date+" "+l.workTime[t].startTime);if(!(r>0))return void c["a"].error("第"+(t+1).toString()+"列数据打卡时间异常！请确定下班时间大于上班时间！");e+=r/1e3/60}}l.totalWorkTime=(e/60).toFixed(2),l.dailyWorkTime=(e/60/l.workTime.length).toFixed(2),l.isCalWorkTime=!0},L=(e,t)=>{"上班时间"!==t.label&&"下班时间"!==t.label||(l.clickRow=e.index,l.clickCell=t.index,l.tabClickLabel=t.label)},J=({row:e,rowIndex:t})=>{e.index=t},H=({column:e,columnIndex:t})=>{e.index=t},q=()=>{l.clickRow=0,l.clickCell=0,l.tabClickLabel=""},G=()=>{z="";for(let e=0;e<l.workTime.length;e++)z+=l.workTime[e].index+"\t"+l.workTime[e].id+"\t"+l.workTime[e].name+"\t"+l.workTime[e].date+"\t"+l.workTime[e].startTime+"\t"+l.workTime[e].endTime+"\n";localStorage.setItem("workTimeData",z)},Q=()=>{l.workTime.splice(0);const e=localStorage.getItem("workTimeData"),t=e.split("\n");M(t)};return(e,c)=>{const z=Object(o["resolveComponent"])("el-table-column"),M=Object(o["resolveComponent"])("el-input"),X=Object(o["resolveComponent"])("el-table"),Y=Object(o["resolveComponent"])("el-button"),Z=Object(o["resolveComponent"])("el-icon"),$=Object(o["resolveComponent"])("el-upload");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",n,[a,Object(o["createElementVNode"])("div",i,[Object(o["createElementVNode"])("div",d,[Object(o["createVNode"])(X,{data:l.workTime,border:"",style:{width:"1100px"},onCellDblclick:L,"row-class-name":J,"cell-class-name":H},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(z,{align:"center",label:"序号",width:"100"},{default:Object(o["withCtx"])(e=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.row.index+1),1)]),_:1}),Object(o["createVNode"])(z,{prop:"id",align:"center",label:"工号",width:"200"}),Object(o["createVNode"])(z,{prop:"name",align:"center",label:"姓名",width:"200"}),Object(o["createVNode"])(z,{align:"center",label:"日期",width:"200"},{default:Object(o["withCtx"])(e=>[e.row.index===l.clickRow&&e.column.index===l.clickCell?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",m,[Object(o["createVNode"])(M,{ref_key:"dateRef",ref:t,modelValue:e.row.date,"onUpdate:modelValue":t=>e.row.date=t,maxlength:"300",size:"small",onKeyup:Object(o["withKeys"])(q,["enter"]),onBlur:q},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",b,Object(o["toDisplayString"])(e.row.date),1))]),_:1}),Object(o["createVNode"])(z,{align:"center",label:"上班时间",width:"200"},{default:Object(o["withCtx"])(e=>[e.row.index===l.clickRow&&e.column.index===l.clickCell?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",s,[Object(o["createVNode"])(M,{ref:"startTimeRef",modelValue:e.row.startTime,"onUpdate:modelValue":t=>e.row.startTime=t,maxlength:"300",size:"small",onKeyup:Object(o["withKeys"])(q,["enter"]),onBlur:q},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",u,Object(o["toDisplayString"])(e.row.startTime),1))]),_:1}),Object(o["createVNode"])(z,{align:"center",label:"下班时间",width:"200","show-overflow-tooltip":""},{default:Object(o["withCtx"])(e=>[e.row.index===l.clickRow&&e.column.index===l.clickCell?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",p,[Object(o["createVNode"])(M,{modelValue:e.row.endTime,"onUpdate:modelValue":t=>e.row.endTime=t,maxlength:"300",size:"small",onKeyup:Object(o["withKeys"])(q,["enter"]),onBlur:q},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",O,Object(o["toDisplayString"])(e.row.endTime),1))]),_:1})]),_:1},8,["data"]),Object(o["withDirectives"])(Object(o["createVNode"])(Y,{style:{position:"absolute",left:"11px",top:"118px","z-index":"2"},type:"primary",icon:Object(o["unref"])(r["b"]),circle:"",onClick:c[0]||(c[0]=e=>l.workTime.splice(0))},null,8,["icon"]),[[o["vShow"],0!==l.workTime.length]]),Object(o["createVNode"])(Y,{style:{position:"absolute",left:"0px",top:"160px","z-index":"2"},type:"primary",icon:Object(o["unref"])(r["a"]),circle:"",onClick:c[1]||(c[1]=e=>A())},null,8,["icon"]),Object(o["withDirectives"])(Object(o["createVNode"])($,{class:"upload-demo",drag:"",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",multiple:"","on-change":F},{tip:Object(o["withCtx"])(()=>[k]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(Z,{class:"el-icon--upload"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(Object(o["unref"])(r["b"]))]),_:1}),j]),_:1},512),[[o["vShow"],0===l.workTime.length]])]),Object(o["createElementVNode"])("div",w,[Object(o["createElementVNode"])("div",f,[T,Object(o["createVNode"])(Y,{type:"primary",onClick:G,style:{"margin-left":"10px"}},{default:Object(o["withCtx"])(()=>[h]),_:1}),Object(o["createVNode"])(Y,{type:"primary",onClick:Q,style:{"margin-left":"10px"}},{default:Object(o["withCtx"])(()=>[y]),_:1}),Object(o["createVNode"])(Y,{type:"primary",onClick:I,style:{"margin-left":"10px"}},{default:Object(o["withCtx"])(()=>[x]),_:1})]),Object(o["createElementVNode"])("div",V,[v,g,Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(l.workTime.length),1),N,C,E,Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(l.totalWorkTime),1),B,_,S,Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(l.dailyWorkTime),1),D,R]),l.isCalWorkTime?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",W,[parseFloat(l.dailyWorkTime)>=8.5?(Object(o["openBlock"])(),Object(o["createElementBlock"])("h3",K,"您的工时已达到公司要求 请再接再厉！")):(Object(o["openBlock"])(),Object(o["createElementBlock"])("h3",P,"您的工时未达到公司要求 请及时调整！"))])):Object(o["createCommentVNode"])("",!0),U])])])}}});l("aab9");const F=z;var M=F,A=l("c3a1"),I=(l("7437"),l("a471"),l("3ef0")),L=l.n(I);const J=Object(o["createApp"])(M);J.use(A["a"],{locale:L.a}),J.mount("#app")}});