(function(e){function t(t){for(var l,n,a=t[0],i=t[1],d=t[2],b=0,s=[];b<a.length;b++)n=a[b],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&s.push(o[n][0]),o[n]=0;for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l]);m&&m(t);while(s.length)s.shift()();return r.push.apply(r,d||[]),c()}function c(){for(var e,t=0;t<r.length;t++){for(var c=r[t],l=!0,a=1;a<c.length;a++){var i=c[a];0!==o[i]&&(l=!1)}l&&(r.splice(t--,1),e=n(n.s=c[0]))}return e}var l={},o={app:0},r=[];function n(t){if(l[t])return l[t].exports;var c=l[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=e,n.c=l,n.d=function(e,t,c){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:c})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(c,l,function(t){return e[t]}.bind(null,l));return c},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var m=i;r.push([0,"chunk-vendors"]),c()})({0:function(e,t,c){e.exports=c("cd49")},"0178":function(e,t,c){},"3e76":function(e,t,c){"use strict";c("0178")},cd49:function(e,t,c){"use strict";c.r(t);var l=c("7a23"),o=c("3ef4"),r=c("f6f2");const n={class:"app-div"},a=Object(l["createElementVNode"])("div",{class:"title-div"},[Object(l["createElementVNode"])("h1",null,"公司工时统计系统")],-1),i={class:"workTime-div"},d={class:"workTime-table"},m={key:0},b={key:1},s={key:0},u={key:1},p={key:0},O={key:1},j=Object(l["createElementVNode"])("div",{class:"el-upload__text"},[Object(l["createElementVNode"])("h3",null,"将文件拖拽到此处或点击图标上传文件")],-1),k=Object(l["createElementVNode"])("div",{class:"el-upload__tip",style:{"text-align":"center"}},[Object(l["createElementVNode"])("h3",null,"请上传文本文件！")],-1),f={class:"workTime-use"},w={class:"function"},T=Object(l["createElementVNode"])("h1",null,"功能模块",-1),h={class:"info"},V=Object(l["createElementVNode"])("h1",null,"工时统计",-1),x=Object(l["createTextVNode"])(" 当月工作时长："),y=Object(l["createTextVNode"])(" 天 "),v=Object(l["createElementVNode"])("br",null,null,-1),N=Object(l["createTextVNode"])(" 总工时："),g=Object(l["createTextVNode"])(" 时 "),C=Object(l["createElementVNode"])("br",null,null,-1),E=Object(l["createTextVNode"])(" 日平均工时： "),_=Object(l["createTextVNode"])(" 时 "),B=Object(l["createElementVNode"])("br",null,null,-1),S={key:0,class:"info"},D={key:0,style:{color:"green"}},R={key:1,style:{color:"red"}},W=Object(l["createElementVNode"])("div",{class:"guide"},[Object(l["createElementVNode"])("h1",{style:{"text-align":"center"}},"使用说明"),Object(l["createElementVNode"])("div",{style:{"margin-left":"10px"}},[Object(l["createElementVNode"])("h5",null,"1.在OA系统中，将需要计算的工时复制到txt文本中；(参考src/assets/test.txt格式)"),Object(l["createElementVNode"])("h5",null,"2.点击表格区域的上传文件按钮打开工时文件，或将工时文件拖拽至目标区域；"),Object(l["createElementVNode"])("h5",null,"3.将有上下班未打卡的时间补充完整(双击单元格更改)；"),Object(l["createElementVNode"])("h5",null,"4.点击计算工时按钮，查看工时统计信息。")])],-1);var K=Object(l["defineComponent"])({__name:"App",setup(e){const t=Object(l["ref"])(),c=Object(l["ref"])(),K=Object(l["ref"])(),P=Object(l["reactive"])({workTime:[],clickRow:0,clickCell:0,tabClickLabel:"",totalWorkTime:"0",dailyWorkTime:"0",isCalWorkTime:!1});let U="";const F=e=>{if("txt"===e.name.split(".").slice(-1)[0])if(window.FileReader){var t=new FileReader;t.onload=e=>{P.workTime.splice(0);const t=e.target.result.split("\n");I(t)},t.readAsText(e.raw)}else o["a"].error("该浏览器不支持文件读取 请更改浏览器 推荐使用谷歌浏览器");else o["a"].error("请选择正确的txt文件")},I=e=>{try{for(let t=0;t<e.length;t++)if(""!==e[t]){const c=e[t].split("\t");P.workTime.push({index:t,id:c[1],name:c[2],date:c[3],startTime:c[4],endTime:c[5]})}o["a"].success("读取数据成功！")}catch(t){o["a"].error("无法正确解析该txt文件")}},M=()=>{P.workTime.splice(0),P.totalWorkTime="0",P.dailyWorkTime="0",P.isCalWorkTime=!1},A=()=>{P.workTime.push({index:P.workTime.length+1,id:"",name:"",date:"",startTime:"",endTime:""}),P.clickRow=P.workTime.length-1,P.clickCell=3,Object(l["nextTick"])(()=>{t.value.input.focus()})},z=()=>{0!==P.workTime.length?(P.workTime.pop(),o["a"].success("减少最后一个数据成功！")):o["a"].error("没有工时数据！")},L=()=>{if(0===P.workTime.length)return void o["a"].error("没有工时数据！");let e=0;for(let t=0;t<P.workTime.length;t++){if(" "===P.workTime[t].startTime)return o["a"].error("第"+(t+1).toString()+"列有未完成的上班打卡 请先双击表格填写完整！"),P.clickRow=t,P.clickCell=4,P.workTime[t].startTime="08:30:00",void Object(l["nextTick"])(()=>{c.value.input.focus()});if(" "===P.workTime[t].endTime)return o["a"].error("第"+(t+1).toString()+"列有未完成的下班打卡 请先双击表格填写完整！"),P.clickRow=t,P.clickCell=5,P.workTime[t].endTime="17:00:00",void Object(l["nextTick"])(()=>{K.value.input.focus()});{const c=new Date(P.workTime[t].date+" "+P.workTime[t].startTime);c.getHours()<=8&&c.getMinutes()<=30&&(P.workTime[t].startTime="08:30:00");const l=Date.parse(P.workTime[t].date+" "+P.workTime[t].endTime)-Date.parse(P.workTime[t].date+" "+P.workTime[t].startTime);if(!(l>0))return void o["a"].error("第"+(t+1).toString()+"列数据打卡时间异常！请确定下班时间大于上班时间！");e+=l/1e3/60}}P.totalWorkTime=(e/60).toFixed(2),P.dailyWorkTime=(e/60/P.workTime.length).toFixed(2),P.isCalWorkTime=!0},J=(e,t)=>{"上班时间"!==t.label&&"下班时间"!==t.label||(P.clickRow=e.index,P.clickCell=t.index,P.tabClickLabel=t.label)},H=({row:e,rowIndex:t})=>{e.index=t},q=({column:e,columnIndex:t})=>{e.index=t},G=()=>{P.clickRow=0,P.clickCell=0,P.tabClickLabel=""},Q=()=>{if(U="",0!==P.workTime.length){for(let e=0;e<P.workTime.length;e++)U+=P.workTime[e].index+"\t"+P.workTime[e].id+"\t"+P.workTime[e].name+"\t"+P.workTime[e].date+"\t"+P.workTime[e].startTime+"\t"+P.workTime[e].endTime+"\n";localStorage.setItem("workTimeData",U),o["a"].success("保存数据成功！")}else o["a"].error("没有工时数据！")},X=()=>{if(P.workTime.splice(0),null===localStorage.getItem("workTimeData"))return void o["a"].error("没有工时数据！");const e=localStorage.getItem("workTimeData"),t=e.split("\n");I(t)};return(e,o)=>{const U=Object(l["resolveComponent"])("el-table-column"),I=Object(l["resolveComponent"])("el-input"),Y=Object(l["resolveComponent"])("el-table"),Z=Object(l["resolveComponent"])("el-icon"),$=Object(l["resolveComponent"])("el-upload"),ee=Object(l["resolveComponent"])("el-col"),te=Object(l["resolveComponent"])("el-button"),ce=Object(l["resolveComponent"])("el-tooltip"),le=Object(l["resolveComponent"])("el-row");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",n,[a,Object(l["createElementVNode"])("div",i,[Object(l["createVNode"])(le,null,{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(ee,{span:18},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",d,[Object(l["createVNode"])(Y,{data:P.workTime,border:"",stripe:"",onCellDblclick:J,"row-class-name":H,"cell-class-name":q,style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(U,{align:"center",label:"序号",width:"65"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.row.index+1),1)]),_:1}),Object(l["createVNode"])(U,{prop:"id",align:"center",label:"工号",width:"200"}),Object(l["createVNode"])(U,{prop:"name",align:"center",label:"姓名",width:"200"}),Object(l["createVNode"])(U,{align:"center",label:"日期",width:"200"},{default:Object(l["withCtx"])(e=>[e.row.index===P.clickRow&&e.column.index===P.clickCell?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",m,[Object(l["createVNode"])(I,{ref_key:"dateRef",ref:t,modelValue:e.row.date,"onUpdate:modelValue":t=>e.row.date=t,maxlength:"300",size:"small",onKeyup:Object(l["withKeys"])(G,["enter"]),onBlur:G},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",b,Object(l["toDisplayString"])(e.row.date),1))]),_:1}),Object(l["createVNode"])(U,{align:"center",label:"上班时间",width:"200"},{default:Object(l["withCtx"])(e=>[e.row.index===P.clickRow&&e.column.index===P.clickCell?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",s,[Object(l["createVNode"])(I,{ref_key:"startTimeRef",ref:c,modelValue:e.row.startTime,"onUpdate:modelValue":t=>e.row.startTime=t,maxlength:"300",size:"small",onKeyup:Object(l["withKeys"])(G,["enter"]),onBlur:G},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",u,Object(l["toDisplayString"])(e.row.startTime),1))]),_:1}),Object(l["createVNode"])(U,{align:"center",label:"下班时间",width:"200","show-overflow-tooltip":""},{default:Object(l["withCtx"])(e=>[e.row.index===P.clickRow&&e.column.index===P.clickCell?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",p,[Object(l["createVNode"])(I,{ref_key:"endTimeRef",ref:K,modelValue:e.row.endTime,"onUpdate:modelValue":t=>e.row.endTime=t,maxlength:"300",size:"small",onKeyup:Object(l["withKeys"])(G,["enter"]),onBlur:G},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",O,Object(l["toDisplayString"])(e.row.endTime),1))]),_:1})]),_:1},8,["data"]),Object(l["withDirectives"])(Object(l["createVNode"])($,{class:"upload-demo",drag:"",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",multiple:"","on-change":F},{tip:Object(l["withCtx"])(()=>[k]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(Z,{class:"el-icon--upload"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(Object(l["unref"])(r["f"]))]),_:1}),j]),_:1},512),[[l["vShow"],0===P.workTime.length]])])]),_:1}),Object(l["createVNode"])(ee,{span:6},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",f,[Object(l["createElementVNode"])("div",w,[T,Object(l["createVNode"])(ce,{class:"box-item",effect:"dark",content:"重新读取文本",placement:"top"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(te,{type:"primary",icon:Object(l["unref"])(r["f"]),circle:"",onClick:o[0]||(o[0]=e=>M())},null,8,["icon"])]),_:1}),Object(l["createVNode"])(ce,{class:"box-item",effect:"dark",content:"保存本地数据",placement:"top"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(te,{type:"primary",icon:Object(l["unref"])(r["a"]),circle:"",onClick:o[1]||(o[1]=e=>Q())},null,8,["icon"])]),_:1}),Object(l["createVNode"])(ce,{class:"box-item",effect:"dark",content:"读取本地数据",placement:"top"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(te,{type:"primary",icon:Object(l["unref"])(r["b"]),circle:"",onClick:o[2]||(o[2]=e=>X())},null,8,["icon"])]),_:1}),Object(l["createVNode"])(ce,{class:"box-item",effect:"dark",content:"增加一行数据",placement:"top"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(te,{type:"primary",icon:Object(l["unref"])(r["e"]),circle:"",onClick:o[3]||(o[3]=e=>A())},null,8,["icon"])]),_:1}),Object(l["createVNode"])(ce,{class:"box-item",effect:"dark",content:"减少一行数据",placement:"top"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(te,{type:"primary",icon:Object(l["unref"])(r["d"]),circle:"",onClick:o[4]||(o[4]=e=>z())},null,8,["icon"])]),_:1}),Object(l["createVNode"])(ce,{class:"box-item",effect:"dark",content:"计算工时",placement:"top"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(te,{type:"primary",icon:Object(l["unref"])(r["c"]),circle:"",onClick:o[5]||(o[5]=e=>L())},null,8,["icon"])]),_:1})]),Object(l["createElementVNode"])("div",h,[V,x,Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(P.workTime.length),1),y,v,N,Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(P.totalWorkTime),1),g,C,E,Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(P.dailyWorkTime),1),_,B]),P.isCalWorkTime?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",S,[parseFloat(P.dailyWorkTime)>=8.5?(Object(l["openBlock"])(),Object(l["createElementBlock"])("h3",D,"您的工时已达到公司要求 请再接再厉！")):(Object(l["openBlock"])(),Object(l["createElementBlock"])("h3",R,"您的工时未达到公司要求 请及时调整！"))])):Object(l["createCommentVNode"])("",!0),W])]),_:1})]),_:1})])])}}});c("3e76");const P=K;var U=P,F=c("c3a1"),I=(c("7437"),c("a471"),c("3ef0")),M=c.n(I);const A=Object(l["createApp"])(U);A.use(F["a"],{locale:M.a}),A.mount("#app")}});