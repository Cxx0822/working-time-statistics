(function(e){function t(t){for(var o,n,a=t[0],i=t[1],d=t[2],b=0,u=[];b<a.length;b++)n=a[b],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&u.push(r[n][0]),r[n]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);s&&s(t);while(u.length)u.shift()();return c.push.apply(c,d||[]),l()}function l(){for(var e,t=0;t<c.length;t++){for(var l=c[t],o=!0,a=1;a<l.length;a++){var i=l[a];0!==r[i]&&(o=!1)}o&&(c.splice(t--,1),e=n(n.s=l[0]))}return e}var o={},r={app:0},c=[];function n(t){if(o[t])return o[t].exports;var l=o[t]={i:t,l:!1,exports:{}};return e[t].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=o,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(l,o,function(t){return e[t]}.bind(null,o));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var s=i;c.push([0,"chunk-vendors"]),l()})({0:function(e,t,l){e.exports=l("cd49")},"6cec":function(e,t,l){"use strict";l("c117")},c117:function(e,t,l){},cd49:function(e,t,l){"use strict";l.r(t);var o=l("7a23"),r=l("3ef4");const c={class:"app-div"},n=Object(o["createElementVNode"])("div",{class:"title-div"},[Object(o["createElementVNode"])("h1",null,"公司工时统计系统")],-1),a={class:"workTime-div"},i={class:"workTime-table"},d={key:0},s={key:1},b={key:0},u={key:1},m={class:"workTime-use"},p={class:"function"},O=Object(o["createElementVNode"])("h1",null,"功能模块",-1),j=Object(o["createTextVNode"])("读取文件"),w=Object(o["createTextVNode"])("计算工时"),f={class:"info"},k=Object(o["createElementVNode"])("h1",null,"工时统计",-1),h=Object(o["createElementVNode"])("br",null,null,-1),y=Object(o["createElementVNode"])("br",null,null,-1),T=Object(o["createElementVNode"])("br",null,null,-1),v=Object(o["createElementVNode"])("div",{class:"guide"},[Object(o["createElementVNode"])("h1",{style:{"text-align":"center"}},"使用说明"),Object(o["createElementVNode"])("div",{style:{"margin-left":"10px"}},[Object(o["createElementVNode"])("h5",null,"1.在OA系统中，将需要计算的工时复制到txt文本中；(参考src/assets/test.txt格式)"),Object(o["createElementVNode"])("h5",null,"2.点击读取文件按钮，打开工时文件；"),Object(o["createElementVNode"])("h5",null,"3.将有上下班未打卡的时间补充完整(双击单元格更改)；"),Object(o["createElementVNode"])("h5",null,"4.点击计算工时按钮，查看工时统计信息。")])],-1);var x=Object(o["defineComponent"])({__name:"App",setup(e){const t=Object(o["ref"])(),l=Object(o["reactive"])({isShowUpLoadFile:!0,workTime:[],clickRow:0,clickCell:0,tabClickLabel:"",totalWorkTime:"0",dailyWorkTime:"0"}),x=()=>{l.isShowUpLoadFile=!0,Object(o["nextTick"])(()=>{t.value.click()})},V=()=>{if(window.FileReader){const o=t.value.files[0];if("txt"===o.name.split(".").slice(-1)[0]){var e=new FileReader;e.onload=e=>{try{l.workTime.splice(0);const t=e.target.result.split("\n");for(let e=0;e<t.length;e++)if(""!==t[e]){const o=t[e].split("\t");l.workTime.push({index:e,id:o[1],name:o[2],date:o[3],startTime:o[4],endTime:o[5]})}l.isShowUpLoadFile=!1}catch(t){r["a"].error("无法正确解析该txt文件")}},e.readAsText(o)}else r["a"].error("请选择正确的txt文件")}else r["a"].error("该浏览器不支持文件读取 请更改浏览器 推荐使用谷歌浏览器")},g=()=>{if(0===l.workTime.length)return void r["a"].error("请先读取工时文件！");let e=0;for(let t=0;t<l.workTime.length;t++){if(" "===l.workTime[t].startTime||" "===l.workTime[t].endTime)return void r["a"].error("第"+(t+1).toString()+"列有未完成的上下班打卡 请先双击表格填写完整！");{const o=new Date(l.workTime[t].date+" "+l.workTime[t].startTime);o.getHours()<=8&&o.getMinutes()<=30&&(l.workTime[t].startTime="08:30:00");const c=Date.parse(l.workTime[t].date+" "+l.workTime[t].endTime)-Date.parse(l.workTime[t].date+" "+l.workTime[t].startTime);if(!(c>0))return void r["a"].error("第"+(t+1).toString()+"列数据打卡时间异常！请确定下班时间大于上班时间！");e+=c/1e3/60}}l.totalWorkTime=(e/60).toFixed(2),l.dailyWorkTime=(e/60/l.workTime.length).toFixed(2)},N=(e,t)=>{"上班时间"!==t.label&&"下班时间"!==t.label||(l.clickRow=e.index,l.clickCell=t.index,l.tabClickLabel=t.label)},E=({row:e,rowIndex:t})=>{e.index=t},C=({column:e,columnIndex:t})=>{e.index=t},S=()=>{l.clickRow=0,l.clickCell=0,l.tabClickLabel=""};return(e,r)=>{const _=Object(o["resolveComponent"])("el-table-column"),B=Object(o["resolveComponent"])("el-input"),D=Object(o["resolveComponent"])("el-table"),F=Object(o["resolveComponent"])("el-button");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",c,[n,Object(o["createElementVNode"])("div",a,[Object(o["createElementVNode"])("div",i,[Object(o["createVNode"])(D,{data:l.workTime,border:"",style:{width:"1100px"},onCellDblclick:N,"row-class-name":E,"cell-class-name":C},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(_,{align:"center",label:"序号",width:"100"},{default:Object(o["withCtx"])(e=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.row.index+1),1)]),_:1}),Object(o["createVNode"])(_,{prop:"id",align:"center",label:"工号",width:"200"}),Object(o["createVNode"])(_,{prop:"name",align:"center",label:"姓名",width:"200"}),Object(o["createVNode"])(_,{prop:"date",align:"center",label:"日期",width:"200"}),Object(o["createVNode"])(_,{align:"center",label:"上班时间",width:"200"},{default:Object(o["withCtx"])(e=>[e.row.index===l.clickRow&&e.column.index===l.clickCell?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",d,[Object(o["createVNode"])(B,{modelValue:e.row.startTime,"onUpdate:modelValue":t=>e.row.startTime=t,maxlength:"300",size:"small",onKeyup:Object(o["withKeys"])(S,["enter"]),onBlur:S},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",s,Object(o["toDisplayString"])(e.row.startTime),1))]),_:1}),Object(o["createVNode"])(_,{align:"center",label:"下班时间",width:"200","show-overflow-tooltip":""},{default:Object(o["withCtx"])(e=>[e.row.index===l.clickRow&&e.column.index===l.clickCell?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",b,[Object(o["createVNode"])(B,{modelValue:e.row.endTime,"onUpdate:modelValue":t=>e.row.endTime=t,maxlength:"300",size:"small",onKeyup:Object(o["withKeys"])(S,["enter"]),onBlur:S},null,8,["modelValue","onUpdate:modelValue","onKeyup"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",u,Object(o["toDisplayString"])(e.row.endTime),1))]),_:1})]),_:1},8,["data"])]),Object(o["createElementVNode"])("div",m,[Object(o["createElementVNode"])("div",p,[O,Object(o["createVNode"])(F,{type:"primary",onClick:x},{default:Object(o["withCtx"])(()=>[j]),_:1}),l.isShowUpLoadFile?(Object(o["openBlock"])(),Object(o["createElementBlock"])("input",{key:0,id:"upLoadFile",ref_key:"upLoadFileRef",ref:t,type:"file",accept:".txt",style:{display:"none"},onChange:V},null,544)):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(F,{type:"primary",onClick:g,style:{"margin-left":"10px"}},{default:Object(o["withCtx"])(()=>[w]),_:1})]),Object(o["createElementVNode"])("div",f,[k,Object(o["createTextVNode"])(" 当月工作时长："+Object(o["toDisplayString"])(l.workTime.length)+" 天 ",1),h,Object(o["createTextVNode"])(" 总工时："+Object(o["toDisplayString"])(l.totalWorkTime)+" 时 ",1),y,Object(o["createTextVNode"])(" 日平均工时： "+Object(o["toDisplayString"])(l.dailyWorkTime)+" 时 ",1),T]),v])])])}}});l("6cec");const V=x;var g=V,N=l("c3a1"),E=(l("7437"),l("a471"),l("3ef0")),C=l.n(E);const S=Object(o["createApp"])(g);S.use(N["a"],{locale:C.a}),S.mount("#app")}});